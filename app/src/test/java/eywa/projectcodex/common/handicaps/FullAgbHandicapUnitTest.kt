package eywa.projectcodex.common.handicaps

import android.content.res.Resources
import eywa.projectcodex.common.utils.ListUtils.transpose
import eywa.projectcodex.common.utils.updateDefaultRounds.UpdateDefaultRoundsTask
import eywa.projectcodex.database.RoundFace
import eywa.projectcodex.database.UpdateType
import eywa.projectcodex.database.rounds.*
import eywa.projectcodex.model.Handicap
import eywa.projectcodex.model.Handicap.HandicapPair
import eywa.projectcodex.model.roundHandicap
import eywa.projectcodex.testUtils.MockDatastore
import kotlinx.coroutines.ExperimentalCoroutinesApi
import kotlinx.coroutines.flow.flow
import kotlinx.coroutines.test.runTest
import org.junit.Assert
import org.junit.Assert.assertEquals
import org.junit.Test
import org.mockito.kotlin.any
import org.mockito.kotlin.doAnswer
import org.mockito.kotlin.doReturn
import org.mockito.kotlin.mock
import java.io.FileInputStream
import kotlin.math.abs
import kotlin.reflect.KClass

@OptIn(ExperimentalCoroutinesApi::class)
class FullAgbHandicapUnitTest {
    private suspend fun runUpdateTask(): List<Any> {
        val allItems = mutableListOf<Any>()

        val repo = mock<RoundRepo> {
            on { fullRoundsInfo } doReturn flow { emit(emptyList()) }
            onBlocking { updateRounds(any()) } doAnswer {
                @Suppress("UNCHECKED_CAST")
                allItems.addAll((it.arguments[0] as Map<Any, UpdateType>).keys)
                Unit
            }
        }

        @Suppress("BlockingMethodInNonBlockingContext")
        val inputStream = FileInputStream("src\\main\\res\\general\\raw\\default_rounds_data.json")
        val resources = mock<Resources> { on { openRawResource(any()) } doReturn inputStream }

        UpdateDefaultRoundsTask(
                repository = repo,
                resources = resources,
                datastore = MockDatastore().mock,
                logger = mock {},
        ).runTask()

        return allItems
    }

    @Suppress("UNCHECKED_CAST")
    private inline fun <reified T> Map<KClass<out Any>, List<Any>>.get() = get(T::class) as List<T>

    private fun List<Any>.asFullRoundInfo(): List<FullRoundInfo> {
        val groupedByClass = groupBy { it::class }
        val info = mutableListOf<FullRoundInfo>()

        for (round in groupedByClass.get<Round>()) {
            val roundId = round.roundId

            info.add(
                    FullRoundInfo(
                            round = round,
                            roundSubTypes = groupedByClass.get<RoundSubType>().filter { it.roundId == roundId },
                            roundArrowCounts = groupedByClass.get<RoundArrowCount>().filter { it.roundId == roundId },
                            roundDistances = groupedByClass.get<RoundDistance>().filter { it.roundId == roundId },
                    )
            )
        }

        return info
    }

    private suspend fun getHandicapData(): List<HandicapData> {
        val allRounds = runUpdateTask().asFullRoundInfo().associateBy { it.round.defaultRoundId!! }
        assertEquals(29, allRounds.size)

        val handicapData = csvData
                // String -> 2d array
                .split("\n").map { it.split(",") }
                .transpose()
                // Ignore headings
                .drop(1)
                .map { HandicapData.fromCsvRow(it, allRounds) }

        assertEquals(111, handicapData.size)
        return handicapData
    }

    @Test
    fun test2023HandicapToScore() = runTest {
        val handicapData = getHandicapData()

        val incorrect = mutableListOf<HandicapOutcome>()
        val freq = mutableMapOf<Int, Int>()

        for (data in handicapData) {
            val pairs = data.getHandicapsToTest()

            for (pair in pairs) {
                val (handicap, score) = pair
                val outcome = Handicap.getScoreForRound(
                        round = data.roundInfo,
                        subType = data.roundInfo.roundSubTypes?.firstOrNull()?.subTypeId,
                        handicap = handicap,
                        innerTenArcher = data.isCompound,
                        arrows = null,
                        use2023Handicaps = true,
                        faces = listOf(data.faceType),
                )!!

                val diff = (outcome - score)
                if (abs(diff) > 0) {
                    incorrect.add(HandicapOutcome(pair, outcome.toDouble(), data.roundName))
                    freq[diff] = freq.getOrDefault(diff, 0) + 1
                }
            }

            // Check that a reasonable number of tests have run
            Assert.assertTrue(pairs.size > 80)
        }

        assertEquals(emptyList<HandicapOutcome>(), incorrect.map { it.toHandicapString() })
    }

    @Test
    fun testScoreTo2023Handicap() = runTest {
        val handicapData = getHandicapData()

        val incorrect = mutableListOf<HandicapOutcome>()
        val freq = mutableMapOf<Int, Int>()

        for (data in handicapData) {
            val pairs = data.getScoresToTest()

            for (pair in pairs) {
                val (handicap, score) = pair
                val outcome = Handicap.getHandicapForRound(
                        round = data.roundInfo,
                        subType = data.roundInfo.roundSubTypes?.firstOrNull()?.subTypeId,
                        score = score,
                        innerTenArcher = data.isCompound,
                        arrows = null,
                        use2023Handicaps = true,
                        faces = listOf(data.faceType),
                )!!

                val diff = (outcome.roundHandicap() - handicap.roundHandicap())
                if (abs(diff) > 0 && !(handicap.roundHandicap() == 150 && outcome > 150)) {
                    incorrect.add(HandicapOutcome(pair, outcome, data.roundName))
                    freq[diff] = freq.getOrDefault(diff, 0) + 1
                }
            }

            // Check that a reasonable number of tests have run
            Assert.assertTrue("pairs too small: ${pairs.size}", pairs.size > 130)
        }

        assertEquals(emptyList<HandicapOutcome>(), incorrect.map { it.toScoreString() })
    }

    companion object {
        private val csvData = """
            isMetric,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,1,1,1,1,1,1,1,1,1,1,1,1,null,null,null,null,null,null,null,null,null
            arrowCount,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,36,36,36,36,36,36,36,36,36,36,36,36,36,24,24,24,24,24,24,24,24,24
            faceSize,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,122,122,122,122,122,122,122,80,80,80,80,80,80,122,122,122,122,122,122,122,122,122
            distance,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,90,70,60,50,40,30,20,50,40,30,20,15,10,100,80,60,50,40,30,20,15,10
            isCompound,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,1,1,1,1,1,1,1,1,1,1,1,1,1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null
            face type,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,TRIPLE,null,null,WORCESTER_FIVE,null,TRIPLE,null,null,null,TRIPLE,TRIPLE,TRIPLE,TRIPLE,null,null,null,TRIPLE,null,null,TRIPLE,null,TRIPLE,TRIPLE,null,TRIPLE,null,TRIPLE,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null
            subtype id,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,null,null,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,null,null,null,null,1,2,3,null,1,2,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null
            round id,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,9,9,9,10,10,10,10,10,11,12,13,14,16,16,16,15,17,17,18,19,21,21,20,22,22,29,29,24,25,26,24,23,25,26,18,19,21,21,20,29,29,24,24,23,25,25,26,26,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null
            round name,York,Hereford / Bristol I,Bristol II,Bristol III,Bristol IV,Bristol V,St George,Albion,Windsor,Windsor 50,Windsor 40,Windsor 30,New Western,Long Western,Western,Western 50,Western 40,Western 30,American,St Nicholas,New National,Long National,National,National 50,National 40,National 30,New Warwick,Long Warwick,Warwick,Warwick 50,Warwick 40,Warwick 30,WA 1440 (90m),WA 1440 (70m) / Metric I,WA 1440 (60m) / Metric II,Metric III,Metric IV,Metric V,Long Metric (Men),Long Metric (Women) / Long Metric I,Long Metric II,Long Metric III,Long Metric IV,Long Metric V,Short Metric I,Short Metric II,Short Metric III,Short Metric IV,Short Metric V,WA Standard Bow,WA 900,WA 70m,WA 60m,WA 50m (Barebow) / Metric 122-50,Metric 122-40,Metric 122-30,WA 50m (Compound),Metric 80-40,Metric 80-30,Bray I,Bray II,Portsmouth,Portsmouth (Triple Face),Stafford,Worcester,Worcester 5 Spot,Vegas300 (Full Face),Vegas300 (Triple Face),WA 18m,WA 25m,WA Combined,WA 18m (Triple Face),Vegas (Triple Face),WA 25m (Triple Face),WA Combined (Triple Face),Bray I Compound,Bray II Compound,Portsmouth Compound,Portsmouth (Triple Face) Compound,Stafford Compound,Vegas300 (Full Face) Compound,Vegas300 (Triple Face) Compound,WA 18m (Full Face) Compound,WA 18m (Triple Face) Compound,Vegas (Triple Face) Compound,WA 25m (Full Face) Compound,WA 25m (Triple Face) Compound,WA Combined  (Full Face) Compound,WA Combined (Triple Face) Compound,90m distance (122cm face),70m distance (122cm face),60m distance (122cm face),50m distance (122cm face),40m distance (122cm face),30m distance (122cm face),20m distance (122cm face),50m distance (80cm face),40m distance (80cm face),30m distance (80cm face),20m distance (80cm face),15m distance (80cm face),10m distance (80cm face),2 dozen 5 zone at 100 yards,2 dozen 5 zone at 80 yards,2 dozen 5 zone at 60 yards,2 dozen 5 zone at 50 yards,2 dozen 5 zone at 40 yards,2 dozen 5 zone at 30 yards,2 dozen 5 zone at 20 yards,2 dozen 5 zone at 15 yards,2 dozen 5 zone at 10 yards
            0,1284,1295,1296,1296,1296,1296,966,972,972,972,972,972,856,863,864,864,864,864,810,756,640,647,648,648,648,648,428,432,432,432,432,432,1400,1415,1429,1438,1440,1440,690,705,713,718,720,720,710,716,720,720,720,719,894,701,710,717,720,720,701,713,720,300,300,600,600,720,300,300,300,300,600,600,1199,600,600,600,1199,294,295,596,596,703,294,294,588,588,588,585,585,1172,1172,340,351,355,359,360,360,360,351,357,360,360,360,360,213,216,216,216,216,216,216,216,216
            1,1281,1294,1296,1296,1296,1296,965,971,972,972,972,972,854,863,864,864,864,864,810,756,639,647,648,648,648,648,427,432,432,432,432,432,1396,1412,1427,1437,1440,1440,687,704,712,718,720,720,709,715,720,720,720,718,893,699,709,716,720,720,699,712,719,300,300,600,600,720,300,300,300,300,599,599,1198,599,599,599,1198,293,294,596,596,702,293,293,586,586,586,584,584,1169,1169,338,350,355,358,360,360,360,350,356,360,360,360,360,212,216,216,216,216,216,216,216,216
            2,1279,1294,1296,1296,1296,1296,963,971,972,972,972,972,852,863,864,864,864,864,810,756,637,647,648,648,648,648,426,432,432,432,432,432,1393,1409,1425,1437,1440,1440,685,702,711,717,720,720,708,715,720,720,720,718,892,697,707,715,720,720,697,710,719,300,300,600,600,719,300,300,300,300,599,599,1198,599,599,599,1198,292,293,595,595,700,292,292,585,585,585,582,582,1166,1166,337,349,354,358,360,360,360,349,355,360,360,360,360,211,216,216,216,216,216,216,216,216
            3,1276,1293,1296,1296,1296,1296,961,971,972,972,972,972,850,862,864,864,864,864,810,756,635,646,648,648,648,648,425,431,432,432,432,432,1389,1406,1423,1436,1440,1440,682,700,710,717,720,720,707,714,719,720,720,717,891,695,705,714,719,720,695,709,718,300,300,600,600,719,300,300,300,300,599,599,1197,599,599,599,1197,292,293,594,594,698,292,292,583,583,583,581,581,1164,1164,335,348,353,357,360,360,360,348,355,359,360,360,360,210,215,216,216,216,216,216,216,216
            4,1272,1292,1296,1296,1296,1296,959,970,972,972,972,972,847,861,864,864,864,864,810,756,633,645,648,648,648,648,424,431,432,432,432,432,1385,1403,1420,1435,1440,1440,680,698,708,716,720,720,705,713,719,720,720,717,890,692,704,713,719,720,693,707,718,299,300,600,600,718,300,300,299,299,598,598,1196,598,598,598,1196,291,292,593,593,696,291,291,582,582,582,579,579,1161,1161,334,346,352,357,360,360,360,347,354,359,360,360,360,209,215,216,216,216,216,216,216,216
            5,1268,1290,1296,1296,1296,1296,957,969,972,972,972,972,844,860,864,864,864,864,810,756,630,645,648,648,648,648,422,430,432,432,432,432,1380,1399,1418,1433,1439,1440,677,696,707,715,719,720,704,711,719,720,720,716,888,690,702,712,718,720,691,706,717,299,300,600,600,718,300,300,299,299,598,598,1195,598,598,598,1195,290,291,591,591,694,290,290,580,580,580,578,578,1157,1157,332,345,351,356,359,360,360,346,353,359,360,360,360,208,215,216,216,216,216,216,216,216
            6,1264,1289,1296,1296,1296,1296,955,969,972,972,972,972,841,859,864,864,864,864,810,756,628,644,648,648,648,648,421,430,432,432,432,432,1376,1396,1415,1432,1439,1440,674,694,705,714,719,720,702,710,718,720,720,715,887,688,700,710,718,720,688,704,716,299,300,600,600,717,300,300,299,299,597,597,1193,597,597,597,1193,289,290,590,590,693,289,289,579,579,579,576,576,1154,1154,331,344,350,355,359,360,360,344,352,358,360,360,360,207,214,216,216,216,216,216,216,216
            7,1260,1287,1296,1296,1296,1296,953,968,972,972,972,972,838,858,864,864,864,864,810,756,625,642,648,648,648,648,419,429,432,432,432,432,1371,1392,1412,1431,1439,1440,671,692,703,713,719,720,701,709,718,720,720,715,885,685,698,709,717,720,686,702,715,298,299,600,600,717,300,300,298,298,596,596,1192,596,596,596,1192,289,290,589,589,691,289,289,577,577,577,575,575,1151,1151,329,343,349,355,359,360,360,343,351,358,360,360,360,206,214,216,216,216,216,216,216,216
            8,1255,1285,1296,1296,1296,1296,950,967,972,972,972,972,835,857,864,864,864,864,810,756,622,641,648,648,648,648,418,429,432,432,432,432,1367,1388,1409,1429,1438,1440,668,689,702,712,718,720,699,707,717,720,720,714,883,683,696,708,717,720,683,700,715,298,299,600,600,716,300,300,298,298,596,595,1190,596,596,595,1190,288,289,588,588,689,288,288,576,576,576,573,573,1148,1148,327,342,348,354,359,360,360,342,350,358,360,360,360,205,213,216,216,216,216,216,216,216
            9,1250,1283,1295,1296,1296,1296,947,966,972,972,972,972,831,855,864,864,864,864,810,756,619,640,648,648,648,648,416,428,432,432,432,432,1362,1383,1405,1427,1438,1440,665,687,700,711,718,720,697,706,717,720,720,713,881,680,694,706,716,720,681,698,713,297,299,600,600,715,300,300,297,297,595,594,1189,595,595,594,1189,287,288,586,586,687,287,287,574,574,574,572,572,1145,1145,325,340,347,353,358,360,360,341,349,357,360,360,360,204,212,216,216,216,216,216,216,216
            10,1245,1281,1295,1296,1296,1296,944,964,972,972,972,972,827,854,863,864,864,864,810,756,616,638,648,648,648,648,414,427,432,432,432,432,1356,1379,1402,1425,1437,1440,662,684,698,709,717,720,695,704,716,720,720,712,879,677,691,704,715,720,678,696,712,297,298,600,600,714,300,300,297,297,594,593,1187,594,594,593,1187,286,287,585,585,685,286,286,573,573,573,570,570,1142,1142,323,339,346,352,358,360,360,339,348,356,360,360,360,203,212,216,216,216,216,216,216,216
            11,1239,1278,1294,1296,1296,1296,940,963,971,972,972,972,823,852,863,864,864,864,810,756,612,636,647,648,648,648,412,426,432,432,432,432,1351,1374,1398,1423,1436,1440,658,682,696,708,717,720,693,703,715,720,720,711,877,675,689,702,714,720,675,694,711,296,298,599,599,713,300,300,296,296,593,592,1184,593,593,592,1184,286,287,583,583,684,286,286,571,571,571,569,569,1140,1140,321,338,345,351,357,360,360,338,347,356,360,360,360,201,211,216,216,216,216,216,216,216
            12,1233,1275,1294,1296,1296,1296,936,961,971,972,972,972,818,849,863,864,864,864,809,756,609,634,647,648,648,648,409,425,432,432,432,432,1345,1369,1394,1421,1436,1440,655,679,694,707,716,720,691,701,715,720,720,710,875,672,687,701,712,719,672,692,710,296,297,599,599,711,300,300,296,296,591,591,1182,591,591,591,1182,285,286,582,582,682,285,285,570,570,570,567,567,1137,1137,319,336,344,351,356,360,360,336,346,355,360,360,360,200,210,216,216,216,216,216,216,216
            13,1226,1271,1293,1296,1296,1296,932,959,971,972,972,972,813,847,862,864,864,864,809,756,605,632,646,648,648,648,407,424,431,432,432,432,1339,1364,1390,1418,1435,1440,651,676,691,705,715,720,689,699,714,720,720,709,872,669,684,699,711,719,669,690,708,295,297,598,598,710,300,300,295,295,590,590,1179,590,590,590,1179,284,285,580,580,680,284,284,568,568,568,566,566,1134,1134,317,335,342,350,356,360,360,335,345,354,360,360,360,199,209,215,216,216,216,216,216,216
            14,1220,1267,1292,1296,1296,1296,928,957,970,972,972,972,808,844,861,864,864,864,808,756,601,630,645,648,648,648,404,422,431,432,432,432,1333,1359,1385,1416,1434,1440,647,673,689,703,714,720,686,697,713,720,720,708,870,665,682,697,710,719,666,687,706,294,296,598,598,708,300,300,294,294,589,588,1177,589,589,588,1177,283,285,579,579,679,283,283,567,567,567,565,565,1131,1131,315,333,341,349,355,360,360,333,344,353,360,360,360,197,208,215,216,216,216,216,216,216
            15,1212,1263,1290,1296,1296,1296,924,955,969,972,972,972,803,841,860,864,864,864,808,756,597,627,645,648,648,648,402,421,430,432,432,432,1327,1354,1381,1413,1432,1439,644,671,687,701,713,719,684,695,712,720,720,706,867,662,679,694,708,718,662,685,705,294,296,597,597,707,300,300,294,294,587,587,1174,587,587,587,1174,283,284,577,577,677,283,283,565,565,565,563,563,1128,1128,313,331,340,347,354,359,360,331,343,353,360,360,360,196,207,215,216,216,216,216,216,216
            16,1205,1259,1289,1295,1296,1296,919,952,968,972,972,972,798,838,859,864,864,864,807,756,593,625,644,648,648,648,399,419,430,432,432,432,1320,1348,1376,1410,1431,1439,639,667,684,700,712,719,681,693,711,719,720,705,865,659,676,692,707,718,659,682,703,293,295,597,597,705,300,300,293,293,586,585,1171,586,586,585,1171,282,283,576,576,676,282,282,564,564,564,562,562,1125,1125,310,330,338,346,354,359,360,330,341,352,359,360,360,194,206,214,216,216,216,216,216,216
            17,1197,1254,1287,1295,1296,1296,914,949,967,972,972,972,792,835,858,863,864,864,806,756,588,622,642,647,648,648,396,418,429,432,432,432,1313,1342,1371,1406,1430,1439,635,664,682,698,711,719,678,690,709,719,720,703,862,655,673,690,705,717,655,679,701,292,294,596,596,703,300,300,292,292,584,584,1168,584,584,584,1168,281,282,574,574,674,281,281,563,563,563,561,561,1123,1123,308,328,337,345,353,359,360,328,340,351,359,360,360,192,204,214,216,216,216,216,216,216
            18,1189,1249,1285,1294,1296,1296,909,946,966,971,972,972,786,831,856,863,864,864,805,756,583,619,641,647,648,648,393,416,428,432,432,432,1306,1336,1366,1403,1428,1438,631,661,679,695,710,718,676,688,708,719,720,702,859,652,670,688,703,716,652,677,699,291,294,595,595,702,300,300,291,291,583,582,1164,583,583,582,1164,280,282,573,573,672,280,280,561,561,561,559,559,1120,1120,305,326,335,344,352,358,360,326,339,350,359,360,360,191,203,213,216,216,216,216,216,216
            19,1180,1244,1282,1293,1296,1296,903,943,965,971,972,972,780,827,854,862,864,864,804,756,579,615,639,646,648,648,390,414,427,431,432,432,1299,1330,1361,1400,1426,1438,626,657,676,693,708,718,673,685,707,718,720,700,856,648,667,685,702,715,648,674,697,290,293,594,594,700,299,299,290,290,581,580,1161,581,581,580,1161,280,281,571,571,671,280,280,560,560,560,558,558,1117,1117,303,324,334,343,351,358,360,324,337,349,358,360,360,189,202,212,215,216,216,216,216,216
            20,1171,1238,1279,1292,1296,1296,897,939,963,970,972,972,774,823,852,862,864,864,803,756,574,612,638,646,648,648,387,412,426,431,432,432,1291,1323,1356,1396,1424,1437,622,654,673,691,707,717,670,683,705,718,720,698,852,644,664,683,700,714,644,671,695,289,292,593,593,698,299,299,289,289,579,578,1157,579,579,578,1157,279,280,570,570,669,279,279,558,558,558,557,557,1114,1114,300,322,332,342,350,357,360,322,336,348,358,360,360,187,201,212,215,216,216,216,216,216
            21,1162,1232,1276,1291,1296,1296,891,936,961,970,972,972,767,819,850,861,864,864,801,756,568,608,636,645,648,648,384,410,425,431,432,432,1283,1316,1350,1392,1422,1436,617,650,670,689,705,717,666,680,704,717,720,696,849,640,661,680,698,713,640,667,693,288,291,592,592,695,298,298,288,288,577,577,1153,577,577,577,1153,278,280,568,568,668,278,278,557,557,557,555,555,1111,1111,297,320,331,340,349,357,360,320,334,347,357,360,360,185,199,211,215,216,216,216,216,216
            22,1153,1225,1273,1290,1296,1296,885,932,959,969,972,972,760,814,847,860,864,864,799,756,563,605,634,644,648,648,380,407,424,430,432,432,1275,1309,1344,1388,1420,1435,612,646,667,686,704,716,663,677,702,717,720,694,846,636,657,677,696,712,636,664,691,287,290,591,591,693,298,298,287,287,575,574,1149,575,575,574,1149,277,279,567,567,666,277,277,555,555,555,554,554,1108,1108,294,318,329,339,348,356,360,318,332,346,357,360,360,183,198,210,214,216,216,216,216,216
            23,1142,1218,1269,1288,1295,1296,878,927,957,968,972,972,753,809,845,858,864,864,798,756,557,601,631,643,648,648,377,405,423,429,432,432,1266,1302,1338,1383,1418,1434,607,642,664,684,702,715,660,675,700,716,720,692,842,631,654,674,693,710,631,661,688,286,289,589,589,691,297,297,286,286,573,572,1145,573,573,572,1145,277,278,566,566,665,277,277,553,553,553,552,552,1105,1105,291,316,327,337,347,355,360,316,331,344,356,360,360,181,196,209,214,216,216,216,216,216
            24,1132,1211,1265,1286,1295,1296,871,922,954,967,972,972,746,804,841,857,863,864,795,755,552,596,629,642,647,648,373,402,421,429,432,432,1257,1294,1332,1379,1415,1433,602,638,661,681,700,714,656,672,698,716,720,690,838,627,650,671,691,709,627,657,686,285,288,588,588,688,297,297,285,285,570,570,1140,570,570,570,1140,276,278,564,564,663,276,276,552,552,552,551,551,1102,1102,288,314,325,336,346,355,360,314,329,343,356,360,360,179,195,208,213,216,216,216,216,216
            25,1121,1204,1260,1284,1294,1296,864,917,952,966,971,972,738,799,838,855,863,864,793,755,546,592,626,640,647,648,369,400,419,428,432,432,1248,1286,1325,1374,1413,1432,596,634,657,679,698,713,653,669,696,715,719,688,835,622,646,668,689,707,622,654,683,284,287,587,587,686,296,296,284,284,568,568,1135,568,568,568,1135,275,277,563,563,661,275,275,550,550,550,549,549,1099,1099,285,311,323,334,345,354,360,311,327,342,355,359,360,177,193,207,213,216,216,216,216,216
            26,1110,1196,1255,1281,1294,1296,856,912,949,964,971,972,730,793,834,854,863,864,791,755,540,588,623,638,647,648,365,397,417,427,432,432,1239,1278,1318,1369,1410,1431,590,630,654,676,696,712,649,665,694,714,719,685,831,617,642,665,686,706,617,650,681,282,286,585,585,683,295,295,282,282,566,566,1131,566,566,566,1131,274,276,562,562,659,274,274,548,548,548,547,547,1095,1095,282,309,321,333,343,353,360,309,325,341,354,359,360,175,191,206,212,216,216,216,216,216
            27,1098,1187,1250,1278,1293,1296,848,907,945,963,971,972,722,787,831,851,862,864,788,754,533,583,620,637,646,648,361,394,416,426,431,432,1229,1270,1311,1364,1407,1430,584,625,650,673,694,711,645,662,692,713,719,683,826,613,638,662,684,704,612,646,678,281,285,583,583,681,294,294,281,281,563,563,1126,563,563,563,1126,273,275,560,560,658,273,273,546,546,546,546,546,1091,1091,278,307,319,331,342,352,360,306,323,339,353,359,360,172,190,205,211,215,216,216,216,216
            28,1086,1178,1244,1275,1292,1296,840,901,942,961,970,972,714,781,826,849,861,864,785,753,526,578,617,635,645,648,357,391,413,425,431,432,1219,1261,1304,1359,1404,1428,578,621,646,670,692,710,641,659,690,712,718,680,822,607,634,658,681,702,607,642,675,280,284,582,582,678,293,293,280,280,560,561,1120,560,560,561,1120,272,275,559,559,656,272,272,544,544,544,544,544,1087,1087,275,304,317,329,341,351,359,304,321,338,353,358,360,170,188,204,210,215,216,216,216,216
            29,1074,1169,1238,1271,1290,1296,832,895,938,959,969,972,705,775,822,846,860,864,782,752,520,573,613,632,645,648,353,388,411,423,430,432,1208,1252,1297,1354,1401,1426,572,616,642,667,690,709,637,655,687,712,718,678,818,602,629,655,679,701,602,638,672,278,283,580,580,675,292,292,278,278,558,558,1115,558,558,558,1115,271,274,558,558,654,271,271,542,542,542,542,542,1083,1083,271,301,315,328,340,351,359,301,319,336,352,358,360,167,186,202,209,215,216,216,216,216
            30,1061,1160,1232,1267,1289,1296,823,888,934,957,969,972,696,769,817,844,859,864,778,751,512,568,609,630,644,648,348,385,409,422,430,432,1197,1243,1289,1348,1397,1424,565,611,638,664,687,708,632,651,685,711,717,675,813,597,625,651,676,699,596,634,669,277,282,578,578,672,291,290,277,277,555,555,1109,555,555,555,1109,270,273,556,556,651,270,270,540,540,540,540,540,1079,1079,267,299,313,326,338,350,359,298,317,335,351,357,360,165,184,201,208,214,216,216,216,216
            31,1047,1150,1225,1263,1287,1296,814,882,929,954,968,972,687,762,813,840,858,864,774,750,505,563,606,627,642,648,344,381,407,420,429,432,1186,1233,1281,1342,1394,1422,559,605,634,660,685,706,628,648,682,710,717,672,808,591,620,647,673,696,590,629,666,275,280,576,576,669,289,289,275,275,552,552,1103,552,552,552,1103,268,272,555,555,649,268,268,538,538,538,537,537,1075,1075,263,296,310,324,337,348,358,295,315,333,350,357,360,162,182,200,207,214,216,216,216,216
            32,1033,1140,1218,1259,1285,1295,804,875,924,951,967,972,677,755,807,837,857,864,770,749,498,557,602,625,641,648,339,378,404,419,429,432,1174,1223,1272,1336,1390,1420,552,600,629,657,682,705,623,644,680,708,716,669,804,585,615,644,670,694,584,625,662,274,279,574,574,665,288,287,274,274,549,549,1097,549,549,549,1097,267,271,553,553,647,267,267,535,535,535,535,535,1070,1070,259,293,308,322,335,347,358,292,313,331,349,356,360,159,180,198,206,213,216,216,216,216
            33,1019,1129,1210,1254,1283,1295,795,868,919,948,965,972,667,747,802,833,855,864,766,747,490,551,598,622,640,648,334,374,401,417,428,432,1162,1213,1264,1330,1386,1418,544,595,625,653,679,703,619,639,677,707,715,666,798,579,610,640,667,692,578,620,659,272,278,572,572,662,286,285,272,272,545,546,1091,545,545,546,1091,266,270,552,552,644,266,266,533,532,532,533,533,1065,1065,255,290,305,320,334,346,357,289,310,330,348,356,360,156,178,197,205,212,216,216,216,216
            34,1004,1118,1202,1248,1280,1295,785,860,914,945,964,972,657,740,797,830,853,863,762,746,482,545,593,618,638,647,329,370,399,415,427,432,1150,1202,1255,1323,1382,1415,537,589,620,649,677,701,614,635,674,706,714,663,793,573,605,635,664,690,572,615,655,270,276,570,570,658,285,284,270,270,542,543,1085,542,542,543,1084,264,269,550,550,641,264,264,530,530,530,530,530,1060,1059,251,287,303,318,332,345,357,286,308,328,347,355,360,153,176,195,204,212,216,216,216,216
            35,989,1107,1194,1243,1278,1294,774,852,909,942,963,971,646,732,791,825,851,863,757,744,473,539,589,615,636,647,323,366,396,413,426,432,1137,1191,1246,1316,1378,1412,529,583,615,646,674,700,608,631,671,705,713,659,788,566,600,631,660,687,565,610,652,269,275,567,567,655,283,281,269,269,539,540,1078,538,538,540,1077,263,268,549,549,639,263,263,527,527,527,528,527,1054,1054,246,283,300,316,330,344,356,283,305,326,345,354,360,150,173,194,203,211,216,216,216,216
            36,973,1095,1186,1237,1274,1293,763,844,903,938,961,971,635,724,785,821,849,862,752,742,465,533,584,612,634,646,318,362,393,411,425,431,1124,1179,1236,1309,1374,1410,521,577,610,642,671,698,603,626,668,703,712,656,782,559,594,626,657,685,558,605,648,267,273,565,565,651,281,279,267,267,535,536,1071,535,535,536,1070,261,266,547,547,636,261,261,524,524,524,525,524,1048,1048,242,280,297,313,329,343,355,279,303,324,344,353,360,147,171,192,201,210,215,216,216,216
            37,957,1083,1177,1230,1271,1292,752,836,897,934,959,970,623,716,779,816,846,862,747,739,456,526,579,608,632,646,312,358,390,408,423,431,1110,1167,1226,1302,1369,1406,513,570,605,638,668,696,598,622,665,702,711,652,776,552,588,622,653,682,551,599,644,265,271,563,563,647,280,276,265,265,531,533,1063,531,531,532,1062,260,265,545,545,633,260,259,521,520,520,522,521,1042,1041,237,276,294,311,327,341,355,276,300,322,343,352,359,144,168,190,200,209,215,216,216,216
            38,940,1070,1168,1224,1267,1291,741,827,890,930,957,970,612,707,772,811,844,861,742,737,446,519,574,604,629,645,306,354,386,406,422,431,1095,1155,1216,1294,1364,1403,504,564,600,633,665,694,592,617,661,700,710,648,770,545,582,617,650,680,544,594,640,263,270,560,560,643,278,274,263,262,527,529,1056,527,527,528,1054,258,264,543,543,629,258,258,517,517,517,519,518,1036,1034,232,273,291,309,325,340,354,272,297,320,342,352,359,141,166,188,199,208,215,216,216,216
            39,923,1057,1158,1217,1263,1290,729,818,884,926,955,969,600,698,766,806,841,860,737,734,437,512,569,600,627,644,300,349,383,403,421,430,1081,1142,1205,1286,1359,1400,495,557,594,629,661,691,586,612,658,699,709,645,764,537,576,612,646,677,536,588,636,261,268,557,557,639,276,270,261,260,523,525,1048,522,522,524,1046,256,262,541,541,626,256,256,514,513,513,515,514,1029,1027,227,269,288,306,323,339,353,268,294,318,340,351,359,137,163,187,197,207,214,216,216,216
            40,905,1044,1148,1209,1259,1288,717,809,877,921,952,968,587,689,759,801,837,859,731,731,427,505,564,596,624,643,294,345,380,401,419,430,1065,1129,1194,1278,1354,1396,486,550,588,624,658,689,580,606,654,697,708,641,757,530,570,607,642,674,528,582,631,259,266,555,555,634,274,267,259,258,519,521,1040,517,517,520,1037,255,261,539,539,622,255,253,510,508,508,512,511,1022,1019,221,265,285,304,321,337,352,264,291,316,339,350,358,134,160,185,196,206,214,216,216,216
            41,887,1030,1138,1202,1254,1286,704,800,870,916,949,967,575,679,752,795,834,858,725,728,417,497,558,591,621,642,288,340,376,398,417,429,1050,1115,1183,1270,1349,1392,477,542,582,620,654,687,574,601,651,695,706,636,751,522,563,602,638,671,520,575,627,257,264,552,552,630,272,263,257,255,515,517,1032,512,512,515,1027,253,259,537,537,618,253,251,507,504,504,508,506,1014,1010,216,261,282,301,319,336,351,260,288,314,337,349,358,130,158,183,194,205,213,216,216,216
            42,868,1015,1127,1194,1249,1284,691,790,862,910,947,966,562,669,744,790,830,856,719,724,407,489,552,587,618,640,281,335,372,395,415,428,1033,1101,1171,1261,1343,1388,467,535,576,615,651,684,567,595,647,693,705,632,744,513,556,596,633,668,512,569,622,254,262,549,549,625,270,259,254,252,511,513,1023,507,507,510,1017,251,258,535,535,614,251,248,503,499,499,505,502,1007,1000,211,257,278,298,317,334,350,256,285,311,336,348,358,127,155,181,192,203,213,216,216,216
            43,849,1000,1116,1185,1243,1282,678,779,855,905,943,965,548,659,737,784,826,855,712,720,397,481,546,582,615,639,274,330,369,392,413,428,1017,1086,1159,1252,1337,1384,457,527,570,610,647,682,560,590,643,691,703,628,737,505,549,590,629,665,503,562,617,252,260,546,545,620,267,255,252,249,506,508,1014,501,501,505,1005,248,256,532,532,610,248,246,498,494,494,501,497,999,990,205,253,275,295,315,333,349,252,281,309,334,346,357,123,152,178,191,202,212,216,216,216
            44,829,985,1105,1176,1238,1280,665,769,847,899,940,964,535,648,729,777,822,853,706,717,386,473,540,577,611,637,268,324,365,389,411,427,999,1071,1146,1243,1331,1380,447,519,563,604,643,679,553,584,639,689,701,623,729,496,542,584,624,662,494,555,612,250,258,542,542,615,265,250,250,246,501,504,1005,495,495,499,993,246,254,530,530,606,246,243,494,488,488,497,492,990,979,199,248,271,292,312,331,348,247,278,306,333,345,356,119,149,176,189,201,211,216,216,216
            45,809,969,1093,1167,1232,1277,651,758,839,893,937,962,521,637,720,771,817,851,699,712,376,464,534,572,608,635,261,319,360,386,409,426,982,1056,1133,1233,1325,1375,436,510,556,599,639,676,546,577,634,686,699,618,721,487,534,578,620,658,485,548,607,247,256,539,539,610,263,245,247,243,496,499,995,488,488,493,980,244,252,527,527,601,244,239,490,481,481,492,486,981,967,193,244,267,289,310,329,347,243,274,304,331,344,356,116,145,174,187,199,210,216,216,216
            46,789,952,1080,1158,1225,1274,637,747,830,886,933,961,507,626,712,764,813,849,692,708,365,455,527,567,604,633,254,313,356,382,407,425,964,1039,1119,1223,1318,1370,426,502,549,593,635,673,538,571,630,684,697,613,713,477,526,572,615,655,475,540,602,244,254,536,535,605,260,240,244,239,491,494,985,481,481,486,967,241,250,524,524,596,241,236,485,475,475,488,480,972,954,187,239,263,286,308,328,346,238,270,301,329,343,355,112,142,172,185,198,209,216,216,216
            47,768,936,1068,1148,1219,1270,622,735,821,880,929,959,492,615,703,757,808,847,684,704,354,446,520,562,600,631,246,308,352,379,404,424,945,1023,1105,1212,1311,1365,415,493,542,588,630,670,531,564,625,681,695,608,705,467,518,565,610,651,465,533,596,242,252,532,531,599,257,234,242,235,486,489,974,473,473,479,952,239,248,521,521,591,239,232,480,467,467,483,473,962,940,181,234,259,283,305,326,345,233,267,298,328,341,354,108,139,169,183,196,208,216,216,216
            48,747,918,1054,1137,1212,1267,608,723,812,873,924,957,478,603,694,750,802,844,677,699,343,436,513,556,596,629,239,302,347,375,401,422,926,1006,1091,1202,1304,1360,404,483,534,582,626,667,523,557,621,679,693,603,697,457,509,559,604,647,455,525,590,239,249,528,528,594,255,228,239,231,480,484,964,465,465,471,936,236,246,518,517,586,236,228,475,459,459,478,466,952,924,175,229,255,280,302,324,344,228,263,295,326,340,354,104,135,167,181,195,207,216,216,216
            49,726,900,1041,1127,1204,1263,593,711,802,866,920,955,463,590,685,743,797,841,669,694,332,427,506,550,591,626,232,295,343,372,399,421,907,988,1076,1191,1297,1354,393,474,526,575,621,664,514,550,616,676,691,597,688,447,501,551,599,643,445,517,584,236,247,524,523,588,252,222,236,226,475,479,953,456,456,463,919,234,244,515,514,580,234,223,469,451,451,473,458,942,908,169,224,251,276,300,322,343,223,259,292,324,339,353,100,132,164,179,193,206,215,216,216
            50,705,882,1027,1116,1197,1259,578,698,793,858,915,953,448,578,675,735,791,838,661,689,320,417,498,544,587,624,224,289,338,368,396,419,887,969,1060,1179,1289,1349,381,464,518,569,616,661,506,543,611,673,689,592,679,436,492,544,593,639,434,508,578,233,244,520,519,581,249,216,233,221,469,473,941,447,447,455,901,231,241,511,510,574,231,219,464,442,442,468,449,931,891,163,218,246,272,297,320,341,217,254,289,322,337,352,97,128,161,177,191,205,215,216,216
            51,684,863,1012,1104,1188,1254,562,685,782,850,910,950,433,565,665,727,785,835,652,684,309,407,491,538,582,621,217,283,333,364,393,418,866,951,1044,1167,1281,1343,370,454,509,562,611,657,497,535,605,670,686,586,669,425,482,537,588,635,423,499,572,230,242,516,514,575,246,209,230,216,463,467,929,437,437,445,882,228,239,508,506,569,228,214,458,432,432,462,441,920,872,157,213,241,269,294,318,340,212,250,286,320,336,351,93,125,159,175,190,204,215,216,216
            52,662,844,997,1092,1180,1250,547,672,772,842,905,948,418,552,654,719,779,832,643,678,298,397,483,531,577,618,209,276,327,360,390,416,846,931,1028,1155,1273,1337,358,443,501,555,606,654,488,527,600,667,684,580,660,414,473,529,582,631,412,490,565,227,239,512,509,568,243,203,227,211,456,461,917,427,427,436,862,225,236,504,501,562,225,209,452,422,422,457,431,908,853,151,207,237,265,291,316,339,206,245,283,318,334,350,89,121,156,172,188,202,214,216,216
            53,640,824,981,1080,1171,1244,531,658,761,834,899,945,404,538,644,710,773,828,634,672,287,386,474,525,572,615,202,269,322,355,387,414,825,911,1011,1142,1264,1331,346,433,492,548,601,650,479,519,594,664,681,574,649,403,463,521,575,626,400,481,558,223,236,508,504,561,240,196,223,205,450,455,904,416,416,425,841,221,234,500,496,556,221,203,446,412,412,451,421,896,833,145,202,232,261,288,313,337,200,241,279,316,333,349,85,117,153,170,186,201,214,216,216
            54,619,804,965,1067,1162,1239,515,644,750,825,893,942,389,525,632,701,766,824,625,666,276,375,466,518,567,611,195,263,316,351,383,412,804,891,993,1129,1255,1324,335,422,483,541,595,646,470,511,589,661,678,567,639,391,453,512,569,622,389,471,551,220,233,503,498,554,236,189,220,200,443,448,891,405,405,415,819,218,231,496,491,549,218,198,439,401,401,444,411,883,811,139,196,227,256,285,311,336,195,236,276,313,331,348,82,113,150,167,184,200,213,216,216
            55,597,784,948,1054,1153,1233,499,629,738,816,887,939,374,511,621,692,759,820,615,660,265,365,457,511,561,608,187,256,311,346,380,410,782,870,975,1115,1246,1317,323,411,473,533,590,642,460,502,582,657,676,560,628,379,442,504,562,617,377,461,544,216,230,498,492,547,233,182,216,194,436,442,877,393,393,404,796,215,228,491,485,542,215,192,432,390,390,438,400,870,789,133,190,221,252,281,309,334,189,231,272,311,329,347,78,110,146,165,182,198,212,216,216
            56,576,763,931,1040,1143,1228,484,615,726,806,881,936,359,497,609,683,752,815,605,654,254,354,447,503,556,604,180,249,305,342,376,408,761,849,956,1101,1237,1310,311,399,463,525,584,638,450,493,576,654,673,553,617,368,431,495,555,612,365,451,536,213,227,493,485,539,229,175,213,188,429,435,863,381,381,392,773,211,225,487,478,535,211,186,425,378,378,431,389,856,766,127,184,216,248,278,306,332,183,226,268,308,327,346,75,106,143,162,180,197,212,216,216
            57,555,742,914,1026,1132,1221,468,600,714,797,874,932,345,482,597,673,745,811,595,647,243,343,438,495,550,600,173,241,299,337,373,406,739,828,937,1086,1227,1303,299,388,453,517,577,634,440,484,570,650,670,546,606,355,420,486,548,607,353,440,528,209,224,488,478,532,225,168,209,182,421,428,848,369,369,381,749,207,222,482,472,527,207,180,418,366,366,424,377,842,743,122,178,210,243,274,304,331,177,220,264,306,326,344,71,102,140,159,178,195,211,216,216
            58,534,721,895,1012,1122,1215,452,585,701,787,867,928,330,468,584,663,737,806,584,640,233,332,428,487,544,596,165,234,292,332,369,403,717,806,917,1071,1217,1295,288,376,443,509,571,630,430,475,563,646,666,539,594,343,409,476,541,601,341,429,520,205,221,483,470,523,221,161,205,176,413,420,833,357,357,369,725,204,219,477,464,519,204,174,410,354,354,417,365,827,719,116,172,205,238,271,301,329,171,215,260,303,324,343,68,98,136,156,176,194,210,215,216
            59,513,700,877,997,1110,1208,436,569,688,776,860,924,316,453,571,652,729,800,573,633,222,321,418,479,538,592,158,227,286,326,365,400,696,784,896,1055,1206,1288,276,364,432,500,565,625,420,465,556,642,663,531,582,331,398,466,533,596,328,418,512,201,217,477,462,515,217,154,201,169,405,413,817,344,344,356,700,200,215,472,456,511,200,168,403,342,342,410,353,812,695,111,166,199,233,267,298,327,164,209,256,301,322,342,64,94,133,153,173,192,209,215,216
            60,492,679,858,981,1099,1201,420,554,674,766,852,920,302,438,558,641,721,795,562,626,212,310,408,471,531,587,151,219,279,321,361,398,674,761,875,1039,1195,1280,265,352,421,491,558,620,410,455,549,638,660,523,570,319,386,456,525,590,316,407,503,197,213,472,453,506,213,147,197,163,397,405,801,332,332,344,675,195,212,467,448,503,195,162,394,329,329,402,341,796,670,106,160,193,228,263,295,326,158,204,252,298,320,341,61,91,129,150,171,190,208,215,216
            61,472,657,838,965,1087,1193,405,538,661,755,844,916,289,424,545,630,712,789,551,618,202,299,398,462,524,583,145,212,273,315,356,395,652,739,854,1023,1184,1271,254,340,410,481,551,615,399,444,542,634,656,515,557,307,374,446,517,584,304,395,494,192,210,466,443,497,209,141,192,157,389,397,785,319,319,331,650,191,208,461,439,494,191,156,386,317,317,394,329,780,645,100,154,187,223,259,292,324,152,198,247,295,318,339,58,87,126,147,168,188,207,214,216
            62,452,635,818,948,1074,1185,389,522,646,743,836,912,275,409,531,619,704,783,539,611,193,287,387,453,517,578,138,205,266,310,352,392,630,716,832,1005,1172,1263,243,328,399,472,543,610,388,434,534,629,653,507,544,295,362,435,509,578,292,383,485,188,206,460,434,488,205,134,188,151,380,388,768,307,307,319,625,187,205,455,429,485,187,149,378,304,304,386,317,763,620,95,148,181,218,255,289,322,146,192,243,292,315,338,55,83,122,144,166,187,206,214,216
            63,432,614,797,931,1061,1177,374,506,632,731,827,907,262,394,517,607,695,777,527,602,183,276,376,444,510,573,131,197,259,304,348,389,609,693,810,988,1160,1254,232,316,387,462,536,605,377,423,526,625,649,498,531,283,350,424,500,572,280,371,475,183,202,454,423,478,200,128,183,144,371,380,750,294,294,306,600,182,201,449,419,475,182,143,369,292,292,377,304,746,596,91,142,175,212,250,286,320,140,186,238,289,313,336,52,80,118,141,163,185,205,213,216
            64,413,592,777,914,1048,1169,359,490,617,719,818,902,250,380,502,594,685,771,514,594,174,266,366,434,503,568,125,190,251,297,343,386,587,671,787,969,1147,1244,221,304,375,452,528,600,367,412,518,620,645,489,517,271,338,413,491,565,268,359,465,179,198,447,413,468,195,122,179,138,362,371,732,282,282,294,575,178,197,443,409,466,178,137,360,280,280,369,292,728,571,86,136,169,207,246,283,318,134,180,233,286,311,335,50,76,115,137,161,183,203,212,216
            65,394,571,755,895,1034,1160,344,474,602,707,809,897,238,365,488,582,675,764,502,585,166,255,354,425,495,562,119,183,244,291,338,382,566,648,764,950,1134,1235,211,293,364,442,520,594,356,401,509,615,641,480,504,259,326,402,481,558,257,347,455,174,194,440,401,458,191,116,174,132,352,362,713,270,270,281,550,173,192,437,398,456,173,131,350,268,268,360,280,710,547,81,130,163,201,241,279,315,129,174,228,282,308,333,47,73,111,134,158,181,202,211,216
            66,376,549,734,877,1020,1151,329,458,587,694,799,891,226,351,473,569,665,757,489,576,157,244,343,415,487,557,113,176,237,285,333,379,545,625,741,931,1121,1225,201,281,352,431,512,588,345,390,501,610,637,471,490,248,313,390,472,551,245,335,444,169,189,433,390,448,186,110,169,126,343,352,694,257,257,269,526,168,188,430,387,445,168,125,341,256,256,351,267,691,523,77,124,157,195,236,276,313,123,168,222,279,306,332,44,69,107,130,155,179,201,211,216
            67,359,528,712,858,1005,1141,315,442,571,681,790,886,214,336,458,556,655,750,476,567,149,234,332,404,479,551,107,168,229,278,328,375,524,602,718,911,1107,1214,191,269,340,420,503,582,334,378,492,605,632,461,476,237,301,378,462,544,234,323,434,164,185,426,378,437,181,104,164,120,333,343,675,246,246,257,502,163,184,423,375,435,163,119,331,244,244,341,256,672,499,73,119,151,189,231,272,311,117,162,217,275,303,330,42,66,103,127,152,176,199,210,216
            68,341,507,690,838,990,1131,301,426,555,667,779,880,203,322,443,542,644,743,463,557,141,224,321,394,471,545,102,161,222,271,322,372,504,580,694,891,1093,1204,182,258,328,409,494,576,323,367,483,599,628,451,461,226,289,366,452,536,223,311,423,159,180,419,366,426,176,99,159,114,323,333,655,234,234,245,479,158,179,416,363,424,158,114,321,232,232,332,244,652,476,69,113,145,183,226,268,308,112,156,212,272,300,328,40,63,99,123,149,174,198,209,216
            69,325,487,668,818,974,1121,287,410,539,653,769,874,193,309,428,528,633,735,449,548,134,214,309,383,462,539,97,155,214,264,317,368,484,558,670,870,1078,1193,172,246,316,398,485,570,312,355,473,593,623,441,447,215,277,354,441,529,212,299,411,154,176,411,354,415,170,93,154,109,313,323,635,223,223,234,456,153,175,408,351,413,153,108,311,221,221,322,232,633,453,65,108,139,177,221,265,306,106,150,206,268,298,326,38,60,96,119,146,172,196,208,216
            70,309,466,646,798,958,1110,274,394,523,639,758,867,182,295,413,514,622,727,436,537,126,204,298,373,453,532,91,148,207,257,311,364,464,536,647,849,1062,1181,164,235,304,386,475,563,301,343,463,588,618,431,432,205,266,342,430,521,202,286,400,149,171,403,341,403,165,88,149,103,302,313,615,212,212,223,434,148,170,401,339,401,148,103,301,210,210,312,221,613,431,61,103,133,171,215,261,303,101,143,200,264,295,324,35,57,92,116,142,169,195,207,215
            71,293,446,624,778,941,1099,261,378,506,625,747,861,173,282,398,500,610,719,422,527,119,194,287,362,444,526,87,141,199,250,305,360,445,514,623,828,1047,1169,155,224,292,375,466,556,290,331,454,581,613,421,418,194,254,330,419,512,192,275,388,144,166,395,329,391,160,84,144,98,292,303,595,201,201,212,412,143,165,393,326,390,143,98,291,200,200,302,210,592,410,58,97,127,165,210,256,301,96,138,194,260,292,322,33,54,88,112,139,167,193,206,215
            72,278,427,602,757,924,1088,248,363,490,610,735,854,163,269,383,486,598,710,408,516,113,185,276,350,434,519,82,135,192,243,299,355,426,493,599,806,1030,1157,147,214,280,363,456,549,279,320,443,575,608,411,403,185,243,318,408,504,182,263,376,139,161,387,316,380,154,79,139,93,282,293,574,191,191,201,391,138,160,384,314,378,138,93,281,190,190,292,200,572,389,55,93,122,159,204,252,298,91,132,188,255,288,320,31,51,84,108,136,164,192,204,215
            73,263,407,580,735,906,1076,236,348,473,595,723,846,154,256,368,471,585,701,395,505,106,176,264,339,424,512,77,128,184,236,293,351,407,472,576,784,1014,1144,139,203,269,351,446,542,269,308,433,569,603,400,389,175,232,306,396,495,173,251,364,134,156,378,304,368,149,74,134,88,272,283,554,181,181,191,371,133,155,376,302,366,133,88,270,180,180,282,190,552,369,52,88,116,153,198,248,295,87,126,182,251,285,318,30,48,81,104,132,161,190,203,214
            74,250,389,558,714,888,1063,224,333,457,579,711,839,145,244,353,456,573,692,381,494,100,167,254,328,415,504,73,122,177,228,287,346,389,451,553,761,997,1131,131,193,257,339,435,534,258,296,422,562,597,390,375,166,221,294,385,485,164,240,352,128,151,369,291,355,144,70,128,84,261,273,533,171,171,181,352,128,150,367,289,354,128,83,260,170,170,272,180,531,349,49,83,111,147,193,243,292,82,120,176,246,282,316,28,46,77,100,128,159,188,202,214
            75,236,370,536,692,870,1050,213,318,441,564,698,831,137,232,339,441,560,682,367,482,95,159,243,317,404,497,69,116,170,221,280,341,371,431,530,738,979,1118,124,184,246,327,424,527,248,285,412,555,592,379,360,157,210,282,373,476,155,229,340,123,146,360,279,343,138,66,123,79,251,262,513,162,162,171,333,123,145,358,277,342,123,79,250,161,161,261,170,511,331,46,79,105,141,187,238,289,78,115,170,242,278,314,26,43,74,97,125,156,186,201,213
            76,223,353,515,671,851,1037,202,304,424,548,685,823,129,220,324,426,546,673,354,470,89,151,232,306,394,489,65,110,162,213,273,337,354,411,507,716,961,1104,117,174,235,315,414,518,237,273,401,548,586,368,346,149,200,270,361,466,147,218,328,118,141,350,267,331,133,62,118,75,241,252,493,153,153,162,315,118,140,349,265,330,118,74,240,152,152,251,161,491,313,43,75,100,135,181,233,286,74,109,164,237,275,311,25,41,70,93,121,153,184,199,212
            77,211,336,493,649,831,1023,191,290,408,532,672,814,122,209,310,411,533,663,340,458,84,143,222,294,383,481,61,105,155,206,267,332,337,392,485,693,942,1089,111,165,224,304,402,510,227,262,390,541,580,357,332,141,190,258,349,456,139,208,316,113,136,341,255,319,128,59,113,71,231,242,472,145,145,153,297,113,135,339,253,318,113,70,230,144,144,241,152,471,296,40,71,95,129,175,228,282,70,104,158,232,271,309,23,38,67,89,117,150,182,198,212
            78,199,319,472,627,812,1009,181,276,392,516,659,805,115,198,296,396,519,652,327,446,79,135,212,283,373,472,58,99,148,198,260,326,321,373,464,670,924,1074,104,157,214,292,391,501,217,251,378,533,573,346,318,133,180,247,337,446,131,197,304,108,131,331,243,307,122,55,108,67,221,232,452,137,137,145,281,108,130,330,242,305,108,66,220,136,136,231,144,451,279,38,67,90,124,169,223,279,66,99,152,227,267,306,22,36,64,85,114,147,180,196,211
            79,188,303,452,605,792,994,171,263,376,500,645,795,108,188,283,381,505,641,313,433,74,128,202,272,362,464,54,94,142,191,253,321,305,355,442,647,904,1059,98,148,203,280,380,493,208,240,367,525,567,335,305,126,171,236,325,435,124,187,292,103,125,321,232,294,117,52,103,63,211,222,433,129,129,137,265,103,125,320,230,293,103,63,210,128,128,221,136,431,264,36,63,86,118,163,218,275,62,94,146,222,263,304,21,34,60,82,110,143,178,195,210
            80,178,287,432,584,771,978,162,250,360,484,631,786,102,178,269,366,490,630,300,421,70,121,192,261,351,455,51,89,135,183,245,315,290,338,422,624,885,1043,93,140,193,269,368,483,198,229,356,517,560,324,291,118,162,225,312,424,117,178,280,99,120,311,220,282,112,49,99,59,202,212,414,122,122,129,250,98,120,310,219,281,98,59,201,121,121,212,128,412,249,34,59,81,113,156,212,272,59,89,140,216,259,301,19,32,57,78,106,140,176,193,209
            81,167,272,412,562,751,963,153,237,345,468,617,776,96,168,257,352,476,619,288,408,66,114,183,250,340,446,48,84,129,176,238,310,276,321,401,601,865,1026,87,133,184,257,357,474,189,218,344,509,553,313,278,112,153,214,300,413,110,169,268,94,115,301,209,271,107,46,94,56,192,203,395,115,115,122,236,94,115,300,208,270,94,56,192,114,114,202,121,393,234,32,56,77,107,150,207,268,55,85,134,211,255,298,18,30,54,75,102,137,174,191,208
            82,158,258,393,540,730,946,144,225,330,452,602,765,90,159,244,337,461,607,275,395,62,108,173,239,329,437,45,80,122,169,231,304,262,305,382,578,844,1009,82,125,174,246,345,464,180,208,333,500,546,302,265,105,145,204,288,401,104,160,256,90,110,291,199,259,102,43,90,53,183,194,376,108,108,115,222,89,110,290,198,258,89,52,183,107,107,193,114,375,221,30,53,73,102,144,201,264,52,80,128,205,251,296,17,29,52,71,98,133,171,190,207
            83,149,244,374,519,709,930,136,214,315,436,587,755,85,150,232,323,447,595,263,382,58,102,165,229,318,427,43,75,116,162,224,298,248,289,363,556,824,992,77,118,165,235,333,455,171,198,321,491,538,292,253,99,137,193,276,390,98,151,245,85,106,281,189,247,97,41,85,50,174,184,358,102,102,108,209,85,105,280,188,247,85,49,174,101,101,184,107,357,208,28,50,69,97,138,195,260,49,76,123,199,246,293,16,27,49,68,94,130,169,188,206
            84,140,231,356,498,688,913,128,203,301,420,573,744,79,142,220,309,432,583,251,369,55,96,156,219,306,417,40,71,110,155,216,292,235,274,344,534,803,974,73,111,157,224,321,444,163,188,310,482,530,281,241,93,130,184,265,378,92,143,234,81,101,271,179,236,92,38,81,47,166,176,341,96,96,102,197,81,101,269,178,235,81,46,165,95,95,175,101,340,196,26,47,65,92,133,189,256,46,72,117,193,241,289,15,25,46,64,91,126,166,186,205
            85,132,218,339,478,667,895,121,192,286,404,557,732,75,134,209,295,417,570,239,356,51,91,148,209,295,407,38,67,105,148,209,285,222,259,327,512,782,956,68,105,148,214,310,434,155,179,299,473,522,270,229,88,122,174,253,366,86,135,223,77,96,260,169,225,88,36,77,44,157,167,324,90,90,96,185,77,96,259,168,224,77,44,157,89,89,166,95,323,184,25,44,61,87,127,183,251,43,68,112,188,236,286,14,24,44,61,87,122,164,184,204
            86,124,206,322,457,645,877,114,181,273,388,542,721,70,126,198,282,402,557,227,343,48,85,140,199,284,397,35,63,99,141,201,279,210,245,310,490,761,937,64,99,140,203,298,424,147,170,287,464,514,260,217,83,115,165,242,354,81,128,212,73,92,250,160,214,84,34,73,41,149,159,308,84,84,90,174,73,91,249,159,214,73,41,149,84,84,158,89,307,173,23,42,58,83,121,177,247,41,64,106,182,231,283,13,22,41,58,83,119,161,182,202
            87,116,194,305,438,624,859,107,172,259,373,527,709,66,119,187,268,387,544,216,330,45,80,133,189,273,387,33,60,94,134,194,272,199,232,293,469,740,918,60,93,133,194,286,413,139,161,276,454,505,249,206,78,109,156,231,342,76,120,202,69,87,240,151,204,79,32,69,39,142,151,292,79,79,84,163,69,87,239,151,203,69,39,141,79,79,150,84,291,162,22,39,55,78,116,171,242,38,60,101,175,226,280,12,21,39,55,80,115,158,180,201
            88,109,183,289,418,603,840,101,162,246,358,512,697,62,112,177,256,373,531,205,318,42,76,125,180,262,376,31,56,89,128,187,266,188,219,277,448,719,898,57,88,125,184,275,402,132,153,265,445,497,239,196,73,102,148,220,330,72,114,192,66,83,230,143,194,75,30,66,36,134,143,276,75,75,79,153,65,83,229,142,193,65,36,134,74,74,142,79,276,153,20,37,51,74,110,165,237,36,57,96,169,221,276,12,20,37,52,76,111,155,178,200
            89,103,173,274,399,582,821,95,153,234,343,496,684,58,106,168,243,358,517,195,305,40,71,118,171,251,365,29,53,84,122,179,259,177,207,262,428,698,878,53,83,118,175,263,391,125,145,254,435,487,229,186,69,96,140,209,318,67,107,182,62,79,220,135,184,71,28,62,34,127,135,262,70,70,75,144,62,79,219,134,183,62,34,127,70,70,135,74,261,143,19,35,48,70,105,159,233,34,54,91,163,216,272,11,19,35,50,73,107,152,175,198
            90,96,163,259,380,561,802,89,144,222,328,481,672,54,99,158,231,344,503,185,292,37,67,112,162,241,355,27,50,79,116,172,252,167,195,248,408,677,858,50,78,112,166,252,380,118,137,243,425,478,219,176,64,91,132,199,305,63,101,173,59,75,211,127,175,67,26,59,32,120,128,248,66,66,70,135,58,75,210,127,174,58,32,120,65,65,128,70,247,134,18,32,46,66,100,153,227,32,51,87,157,210,269,10,18,33,47,69,103,149,173,197
            91,91,153,245,362,540,783,84,136,210,313,465,659,51,93,149,219,329,489,175,280,35,63,105,154,230,344,26,47,75,110,165,245,158,184,234,389,656,837,47,73,105,157,241,369,111,129,233,415,469,209,166,60,85,125,189,293,59,95,164,55,71,201,120,165,64,24,55,30,113,121,234,62,62,66,127,55,71,200,119,165,55,30,113,61,61,121,65,233,126,17,30,43,63,95,147,222,30,48,82,151,204,265,10,16,31,44,66,100,146,171,195
            92,85,144,232,345,520,763,79,128,199,299,450,646,48,88,141,208,315,475,166,268,33,59,99,146,220,333,24,44,71,104,158,238,149,173,221,370,635,816,44,69,99,149,230,357,105,122,222,405,459,200,157,57,80,118,179,281,56,89,155,52,67,192,113,157,60,23,52,28,107,114,221,58,58,62,119,52,67,191,113,156,52,28,107,58,58,114,61,220,118,16,29,40,59,90,141,217,28,45,78,145,199,261,9,15,29,42,63,96,143,168,193
            93,80,136,219,328,500,744,74,121,189,285,435,633,45,83,133,197,302,461,157,256,31,56,94,138,210,322,23,42,67,99,151,231,140,163,208,352,614,794,41,64,93,141,220,346,99,115,212,395,449,190,149,53,76,111,170,270,52,84,146,49,64,183,107,148,57,21,49,27,101,108,209,54,54,58,112,49,63,182,106,148,49,26,101,54,54,108,58,208,111,15,27,38,56,85,135,211,26,42,73,139,193,256,9,15,27,40,60,92,139,166,192
            94,75,128,207,312,480,724,70,114,178,272,419,619,42,78,125,187,288,447,149,244,29,52,88,131,200,311,21,39,63,94,144,224,132,154,196,335,594,772,39,60,88,133,210,334,94,109,202,385,438,181,140,50,71,105,161,258,49,79,138,47,60,174,100,140,54,20,47,25,95,102,197,51,51,54,105,46,60,173,100,140,46,25,95,51,51,102,54,196,104,14,25,36,53,81,129,206,25,40,69,133,187,252,8,14,26,38,57,88,136,163,190
            95,70,120,195,296,460,704,65,107,168,259,404,606,39,73,118,177,275,432,140,233,27,49,83,124,191,300,20,37,59,89,138,216,124,145,185,318,573,750,36,57,83,126,200,323,88,103,193,374,428,173,132,47,67,99,153,247,46,74,131,44,57,165,94,132,51,19,44,23,90,96,186,48,48,51,98,44,57,165,94,132,44,23,90,47,47,96,51,185,98,13,24,34,50,77,124,200,23,37,66,127,181,247,8,13,24,35,54,85,132,160,188
            96,66,113,184,280,441,684,61,101,159,246,389,592,37,68,111,167,262,418,133,222,25,46,78,117,182,289,19,34,56,84,131,209,117,136,174,301,553,728,34,53,78,119,190,312,83,97,183,364,417,164,125,44,63,93,144,235,43,70,123,41,54,157,89,125,48,18,41,22,85,91,175,45,45,48,92,41,54,157,88,125,41,22,84,44,44,91,47,174,91,12,22,32,47,72,118,194,22,35,62,122,175,243,7,12,23,33,51,81,129,158,186
            97,62,106,173,266,422,664,57,95,150,234,374,579,34,64,105,158,250,403,125,211,24,43,74,110,173,279,17,32,53,79,125,202,110,128,164,286,534,706,32,50,73,112,180,300,78,91,174,354,406,156,118,41,59,87,136,224,41,66,116,39,51,149,83,118,45,17,39,21,80,85,165,42,42,45,86,39,51,149,83,118,39,20,79,42,42,85,44,164,86,11,21,30,44,68,112,188,21,33,58,116,169,238,7,11,22,31,48,77,125,155,184
            98,58,99,163,252,403,644,54,89,142,222,360,565,32,60,98,149,237,389,118,201,22,40,69,104,164,268,16,30,49,75,119,195,103,120,154,270,514,684,30,47,69,105,171,289,74,86,165,343,395,148,111,39,55,82,129,214,38,62,110,37,48,141,78,111,42,16,37,19,75,81,155,39,39,42,81,37,48,141,78,111,37,19,75,39,39,80,42,155,80,11,20,28,41,65,107,182,19,31,55,111,163,233,6,11,20,30,46,74,121,152,182
            99,54,93,154,238,385,624,51,84,133,210,345,551,30,56,92,141,226,375,111,191,21,38,65,98,156,257,15,28,46,71,113,188,97,113,145,256,495,661,28,44,64,99,162,278,70,81,157,333,384,140,104,36,52,77,122,203,36,58,103,34,45,134,74,105,40,15,34,18,71,76,146,37,37,39,76,34,45,133,73,104,34,18,70,37,37,76,39,145,75,10,18,26,39,61,102,176,18,29,52,105,157,228,6,10,19,28,43,70,118,149,180
            100,51,88,145,225,368,605,47,79,126,199,331,537,28,53,87,133,214,360,105,181,19,36,61,92,148,247,14,27,44,67,107,180,91,106,136,242,476,639,26,41,61,94,154,267,65,76,149,323,373,133,98,34,49,73,115,193,33,54,97,32,43,127,69,99,38,14,32,17,66,71,137,34,34,37,71,32,42,126,69,98,32,17,66,34,34,71,37,137,70,9,17,25,37,58,97,170,17,27,49,100,150,223,6,9,18,26,41,67,114,145,178
            101,47,82,136,213,351,585,44,74,118,189,317,523,26,50,82,125,203,346,99,171,18,33,57,87,140,237,13,25,41,63,102,173,85,100,128,229,458,617,24,39,57,88,146,256,61,71,141,312,361,126,92,32,46,68,108,183,31,51,92,30,40,120,65,93,35,13,30,16,62,67,129,32,32,34,66,30,40,119,65,93,30,16,62,32,32,67,34,129,66,9,16,23,34,54,92,164,16,26,46,95,144,217,5,9,17,25,39,64,110,142,176
            102,44,77,128,201,334,566,42,69,111,179,303,509,25,47,77,118,193,332,93,162,17,31,54,82,132,227,13,24,39,59,97,166,80,94,120,216,439,594,23,36,53,83,138,245,58,67,133,302,350,119,87,30,43,64,102,174,29,48,86,29,38,113,61,87,33,12,29,15,59,63,121,30,30,32,62,29,38,113,61,87,29,15,58,30,30,63,32,121,62,8,15,22,32,51,87,158,15,24,43,90,139,212,5,8,16,23,36,61,106,139,174
            103,42,72,120,189,318,547,39,65,105,169,290,495,23,44,72,111,182,319,87,154,16,29,51,77,125,217,12,22,36,56,91,160,75,88,113,204,422,572,21,34,50,78,130,234,54,63,126,292,338,113,82,28,40,60,96,165,27,45,81,27,36,107,57,82,31,11,27,14,55,59,114,28,28,30,58,27,35,107,57,82,27,14,55,28,28,59,30,113,58,8,14,20,30,48,83,152,14,23,41,86,133,206,5,8,15,22,34,58,102,135,171
            104,39,68,113,179,302,528,37,61,99,160,277,482,22,41,67,104,173,305,82,145,15,27,47,73,118,207,11,21,34,52,87,153,71,82,106,192,404,550,20,32,47,73,123,224,51,59,119,281,327,106,77,26,37,56,90,156,26,42,76,25,33,101,54,77,29,11,25,13,52,56,107,26,26,28,54,25,33,101,53,77,25,13,52,26,26,55,28,107,54,7,13,19,28,45,78,146,13,21,38,81,127,201,4,7,14,21,32,55,99,132,169
            105,37,64,106,168,287,509,34,57,93,151,264,468,20,38,63,98,163,292,77,137,14,26,44,68,112,197,10,19,32,49,82,146,66,77,99,181,387,529,19,30,44,69,116,214,48,56,113,271,315,100,72,24,35,53,85,148,24,39,72,24,31,95,50,73,28,10,24,12,49,52,100,25,25,27,51,24,31,95,50,72,24,12,48,25,25,52,26,100,51,7,12,18,27,43,74,140,12,20,36,77,121,195,4,7,13,19,30,52,95,128,166
            106,34,60,99,159,273,491,32,54,87,142,252,454,19,36,59,92,154,279,73,130,13,24,42,64,106,188,10,18,30,46,77,140,62,72,93,171,370,507,18,28,41,65,110,204,45,52,106,261,304,95,68,23,33,50,80,140,23,37,67,22,30,90,47,68,26,9,22,11,46,49,94,23,23,25,48,22,29,89,47,68,22,11,45,23,23,49,25,94,47,6,12,17,25,40,70,134,12,19,34,73,116,189,4,6,12,18,29,49,91,125,164
            107,32,56,93,149,259,473,30,50,82,134,239,441,18,34,56,87,146,266,68,123,12,23,39,60,100,179,9,17,28,44,73,133,58,68,87,161,354,486,17,26,39,61,104,194,42,49,100,251,292,89,63,21,31,47,75,132,21,35,63,21,28,84,44,64,24,9,21,11,43,46,88,22,22,23,45,21,28,84,44,64,21,11,43,22,22,46,23,88,44,6,11,16,24,38,66,128,11,18,32,69,110,183,4,6,12,17,27,46,87,121,161
            108,30,52,87,140,245,455,28,47,77,126,228,427,17,32,52,81,137,254,64,116,12,21,37,57,94,171,9,16,26,41,69,127,55,64,82,151,338,465,15,24,36,57,98,185,40,46,95,241,281,84,60,20,29,44,71,125,20,32,59,20,26,80,41,60,23,8,20,10,40,43,83,20,20,22,42,20,26,79,41,60,20,10,40,20,20,43,22,83,41,6,10,15,22,36,63,123,10,16,30,65,105,177,3,6,11,16,25,44,84,117,158
            109,28,49,82,132,232,438,26,44,72,119,217,414,16,30,49,77,130,242,60,109,11,20,34,53,88,162,8,15,25,39,65,121,51,60,77,142,323,445,15,23,34,54,92,176,37,43,89,232,270,79,56,19,27,41,66,118,19,30,56,18,25,75,39,56,21,8,18,9,38,41,78,19,19,20,39,18,24,75,39,56,18,9,37,19,19,40,20,77,39,5,10,14,21,33,59,117,10,15,28,61,100,171,3,5,10,15,24,42,80,113,155
            110,26,46,77,124,220,421,25,41,68,112,206,401,15,28,46,72,122,230,56,103,10,19,32,50,83,154,8,14,23,36,61,115,48,56,72,134,308,425,14,21,32,50,87,167,35,40,84,222,259,75,52,18,25,38,62,111,17,28,52,17,23,70,36,53,20,7,17,9,35,38,73,18,18,19,36,17,23,70,36,53,17,9,35,18,18,38,19,73,36,5,9,13,19,31,56,112,9,14,26,58,95,165,3,5,10,14,23,39,76,109,152
            111,25,43,72,117,208,404,23,39,63,106,195,387,14,26,43,67,115,219,53,97,10,17,30,47,78,146,7,13,22,34,58,110,45,52,67,126,294,406,13,20,30,47,81,158,33,38,79,213,248,70,49,17,24,36,58,105,16,27,49,16,22,66,34,50,19,7,16,8,33,36,68,17,17,18,34,16,22,66,34,50,16,8,33,17,17,36,18,68,34,5,9,12,18,29,53,106,8,14,25,55,90,158,3,5,9,13,21,37,73,106,149
            112,23,40,68,110,197,388,22,36,59,99,185,374,13,24,40,63,108,208,50,91,9,16,28,44,74,139,7,12,20,32,54,104,42,49,63,118,280,387,12,19,28,44,77,150,31,35,74,203,237,66,46,15,22,34,55,98,15,25,46,15,20,62,32,47,18,6,15,8,31,33,64,16,16,17,32,15,20,62,32,46,15,8,31,16,16,33,17,64,32,4,8,11,17,28,49,101,8,13,23,52,85,152,3,4,8,12,20,35,70,102,146
            113,22,38,63,103,186,372,20,34,56,93,175,362,12,23,38,59,102,197,47,86,8,15,27,41,69,131,6,12,19,30,51,99,39,46,59,111,266,368,11,18,26,42,72,142,29,33,70,194,227,62,43,14,21,32,51,93,14,23,43,14,19,58,30,44,17,6,14,7,29,31,60,15,15,16,30,14,19,58,30,44,14,7,29,15,15,31,16,60,30,4,7,11,16,26,47,96,7,12,22,49,81,146,3,4,8,12,19,33,66,98,143
            114,20,35,59,97,175,356,19,32,52,88,166,349,11,21,35,56,96,187,44,81,8,14,25,39,65,124,6,11,18,28,48,94,37,43,55,104,253,351,10,17,25,39,68,135,27,31,66,186,216,58,40,14,20,30,48,87,13,22,40,13,18,55,28,41,16,6,13,7,27,29,56,14,14,15,28,13,18,55,28,41,13,7,27,14,14,29,15,56,28,4,7,10,15,24,44,91,7,11,20,46,77,140,2,4,7,11,18,31,63,94,140
            115,19,33,56,91,166,341,18,30,49,82,157,336,11,20,33,52,90,177,41,76,7,13,23,36,61,117,6,10,17,26,45,89,35,40,52,98,240,333,10,15,23,36,64,127,25,29,62,177,206,55,38,13,18,28,45,82,13,20,38,13,17,52,26,38,15,5,13,6,25,28,52,13,13,14,26,13,17,51,26,38,13,6,25,13,13,27,14,52,26,4,7,9,14,23,41,87,7,10,19,43,72,134,2,4,7,10,17,29,60,90,136
            116,18,31,52,85,156,327,17,28,46,77,148,324,10,19,31,49,85,167,38,71,7,13,22,34,58,111,5,10,16,25,43,84,32,38,48,92,228,316,9,15,22,34,60,120,24,27,58,169,197,52,35,12,17,26,42,77,12,19,36,12,16,48,25,36,14,5,12,6,24,26,49,12,12,13,24,12,16,48,24,36,12,6,24,12,12,26,13,49,24,4,6,9,13,21,39,82,6,10,18,40,68,129,2,4,7,10,16,28,57,87,133
            117,17,29,49,80,147,312,16,26,43,73,140,312,9,17,29,46,80,158,36,67,6,12,20,32,54,105,5,9,15,23,40,79,30,35,45,86,216,300,9,14,20,32,56,114,22,26,54,161,187,48,33,11,16,24,40,72,11,18,33,11,15,45,23,34,13,5,11,6,22,24,46,11,11,12,23,11,15,45,23,34,11,6,22,11,11,24,12,46,23,3,6,8,12,20,36,78,6,9,17,38,65,123,2,3,6,9,15,26,54,83,129
            118,15,27,46,75,139,299,15,24,40,68,132,300,9,16,27,43,75,150,34,63,6,11,19,30,51,99,5,8,14,22,38,75,28,33,42,81,205,285,8,13,19,30,53,107,21,24,51,153,178,45,31,10,15,23,37,68,10,17,31,10,14,43,21,32,12,4,10,5,21,23,43,11,11,11,21,10,14,43,21,32,10,5,21,11,11,23,11,43,21,3,5,8,12,19,34,74,5,9,16,36,61,117,2,3,6,9,14,24,51,79,126
            119,15,25,43,70,130,285,14,23,38,64,125,288,8,15,25,40,70,141,32,59,6,10,18,28,48,93,4,8,13,20,35,71,27,31,40,76,194,270,8,12,18,28,49,101,19,22,48,145,169,43,29,10,14,21,35,64,10,16,29,10,13,40,20,30,11,4,10,5,20,21,40,10,10,11,20,10,13,40,20,30,10,5,20,10,10,21,11,40,20,3,5,7,11,18,32,70,5,8,15,34,58,112,2,3,5,8,13,23,48,76,122
            120,14,24,40,66,123,272,13,21,35,60,118,277,8,14,24,38,66,133,30,55,5,10,17,26,45,88,4,7,12,19,33,67,25,29,37,71,184,255,7,11,17,26,46,95,18,21,45,138,160,40,27,9,13,20,33,60,9,15,27,9,12,38,19,28,11,4,9,5,18,20,38,9,9,10,19,9,12,37,19,28,9,5,18,9,9,20,10,38,19,3,5,7,10,17,30,66,5,8,14,32,54,107,2,3,5,8,12,22,46,72,118
            121,13,22,37,62,115,260,12,20,33,56,111,265,7,13,22,35,62,126,28,52,5,9,16,25,42,83,4,7,11,18,31,63,23,27,35,66,174,242,7,10,16,25,43,90,17,20,42,131,152,38,26,9,12,19,31,56,8,14,26,9,11,35,18,26,10,4,9,4,17,19,35,9,9,9,18,9,11,35,18,26,9,4,17,9,9,19,9,35,17,3,5,6,10,16,28,62,4,7,13,30,51,101,2,3,5,7,11,20,43,69,114
            122,12,21,35,58,109,247,11,19,31,53,104,254,7,13,21,33,58,119,26,49,5,9,15,23,39,78,4,7,11,17,29,60,22,25,33,62,164,228,6,10,15,23,41,85,16,18,40,124,144,35,24,8,12,18,29,53,8,13,24,8,11,33,17,24,9,3,8,4,16,17,33,8,8,9,16,8,11,33,16,24,8,4,16,8,8,17,9,33,16,2,4,6,9,15,27,59,4,7,12,28,48,96,2,3,5,7,11,19,41,66,111
            123,11,19,33,54,102,235,11,18,29,50,98,243,6,12,20,31,54,112,24,46,4,8,14,22,37,74,3,6,10,16,27,56,20,24,30,58,155,216,6,9,14,22,38,80,15,17,37,117,136,33,22,8,11,16,27,50,7,12,22,8,10,31,15,23,9,3,8,4,15,16,31,8,8,8,15,8,10,31,15,23,8,4,15,8,8,16,8,31,15,2,4,6,8,14,25,55,4,6,11,26,45,91,2,2,4,6,10,18,39,63,107
            124,10,18,31,51,96,224,10,16,27,46,92,233,6,11,18,29,51,105,23,43,4,8,13,20,35,69,3,6,9,15,26,53,19,22,28,55,146,204,6,9,13,20,36,75,14,16,35,111,129,31,21,7,10,15,25,46,7,11,21,7,9,29,14,21,8,3,7,4,14,15,29,7,7,8,14,7,9,29,14,21,7,4,14,7,7,15,8,29,14,2,4,5,8,13,23,52,4,6,11,25,43,87,1,2,4,6,9,17,37,59,103
            125,10,17,29,48,90,213,9,15,25,44,87,222,6,10,17,27,48,99,21,40,4,7,12,19,32,65,3,5,9,14,24,50,18,21,27,51,138,192,5,8,12,19,34,71,13,15,33,105,122,29,20,7,10,14,24,44,7,11,20,7,9,27,14,20,8,3,7,4,13,14,27,7,7,7,13,7,9,27,14,20,7,4,13,7,7,14,7,27,13,2,4,5,7,12,22,49,4,6,10,23,40,82,1,2,4,6,9,16,34,56,99
            126,9,16,27,45,85,202,9,14,24,41,82,212,5,10,16,25,45,93,20,38,4,7,11,18,30,61,3,5,8,13,23,47,17,19,25,48,130,181,5,8,11,18,31,66,12,14,31,99,115,27,18,6,9,13,22,41,6,10,18,6,8,25,13,19,7,3,6,3,12,13,25,6,6,7,13,6,8,25,13,19,6,3,12,6,6,13,7,25,13,2,3,5,7,11,21,46,3,5,9,22,38,78,1,2,4,5,8,15,33,54,95
            127,9,15,25,42,79,192,8,14,22,38,77,202,5,9,15,24,42,88,19,35,4,6,11,17,29,58,3,5,8,12,21,44,16,18,23,45,122,171,5,7,11,17,30,62,12,13,29,93,109,25,17,6,8,13,21,38,6,9,17,6,8,24,12,18,7,3,6,3,12,13,24,6,6,6,12,6,8,24,12,17,6,3,12,6,6,13,6,24,12,2,3,4,7,11,19,43,3,5,9,20,36,74,1,2,3,5,8,14,31,51,91
            128,8,14,24,39,74,182,8,13,21,36,72,193,5,9,14,22,39,82,17,33,3,6,10,16,27,54,3,5,7,11,20,41,15,17,22,42,115,161,4,7,10,16,28,59,11,12,27,88,103,24,16,6,8,12,19,36,5,9,16,6,7,22,11,16,6,2,6,3,11,12,22,6,6,6,11,6,7,22,11,16,6,3,11,6,6,12,6,22,11,2,3,4,6,10,18,41,3,5,8,19,33,70,1,2,3,5,7,13,29,48,88
            129,8,13,22,37,70,173,7,12,20,34,68,184,4,8,13,21,37,77,16,31,3,5,9,15,25,51,2,4,7,11,19,39,14,16,20,39,109,151,4,6,9,15,26,55,10,12,25,83,97,22,15,5,7,11,18,34,5,8,15,5,7,21,10,15,6,2,5,3,10,11,21,5,5,6,10,5,7,21,10,15,5,3,10,5,5,11,6,21,10,2,3,4,6,9,17,38,3,4,8,18,31,66,1,2,3,4,7,12,27,45,84
            130,7,12,21,34,66,164,7,11,18,31,64,175,4,8,12,20,35,73,15,29,3,5,9,14,23,48,2,4,6,10,18,37,13,15,19,37,102,142,4,6,9,14,24,52,10,11,24,78,91,21,14,5,7,10,17,32,5,8,14,5,6,20,10,14,6,2,5,3,10,10,19,5,5,5,10,5,6,20,10,14,5,3,10,5,5,10,5,19,10,2,3,4,5,9,16,36,3,4,7,17,29,62,1,2,3,4,6,12,26,43,80
            131,7,11,19,32,61,155,6,10,17,29,60,166,4,7,12,18,32,68,14,27,3,5,8,13,22,45,2,4,6,9,16,34,12,14,18,34,96,134,4,6,8,13,23,48,9,10,22,74,86,20,13,5,6,10,16,30,5,7,13,5,6,18,9,13,5,2,5,3,9,10,18,5,5,5,9,5,6,18,9,13,5,2,9,5,5,10,5,18,9,2,3,3,5,8,15,34,3,4,7,16,28,59,1,2,3,4,6,11,24,41,77
            132,6,11,18,30,58,147,6,10,16,28,56,158,4,7,11,17,30,64,13,25,3,5,8,12,21,42,2,4,6,9,15,32,11,13,17,32,90,126,3,5,8,12,21,45,8,10,21,70,81,18,12,4,6,9,15,28,4,7,12,4,6,17,9,13,5,2,4,2,8,9,17,4,4,5,9,4,6,17,9,13,4,2,8,4,4,9,5,17,8,2,2,3,5,8,14,32,2,4,6,15,26,55,1,2,3,4,6,10,23,38,73
            133,6,10,17,28,54,139,6,9,15,26,53,149,3,6,10,16,28,60,13,24,3,4,7,11,19,39,2,3,5,8,14,30,11,12,16,30,85,118,3,5,7,11,20,43,8,9,19,65,76,17,12,4,6,9,14,26,4,6,12,4,5,16,8,12,5,2,4,2,8,9,16,4,4,4,8,4,5,16,8,12,4,2,8,4,4,9,4,16,8,1,2,3,5,7,13,30,2,3,6,14,24,52,1,1,2,3,5,10,21,36,70
            134,6,9,16,26,51,131,5,9,14,24,49,142,3,6,10,15,27,57,12,22,2,4,7,11,18,37,2,3,5,8,14,29,10,11,15,28,80,111,3,5,7,11,19,40,7,8,18,62,72,16,11,4,5,8,13,24,4,6,11,4,5,15,8,11,4,2,4,2,7,8,15,4,4,4,8,4,5,15,8,11,4,2,7,4,4,8,4,15,7,1,2,3,4,7,12,28,2,3,6,13,23,49,1,1,2,3,5,9,20,34,67
            135,5,9,15,25,47,124,5,8,13,23,46,134,3,5,9,14,25,53,11,21,2,4,6,10,17,35,2,3,5,7,13,27,9,11,14,26,75,104,3,4,6,10,18,38,7,8,17,58,67,15,10,4,5,8,12,23,4,6,10,4,5,14,7,10,4,2,4,2,7,8,14,4,4,4,7,4,5,14,7,10,4,2,7,4,4,8,4,14,7,1,2,3,4,6,12,26,2,3,5,12,21,46,1,1,2,3,5,8,19,32,63
            136,5,8,14,23,44,117,5,8,12,21,43,127,3,5,8,13,23,50,10,20,2,4,6,9,16,33,2,3,4,7,12,25,9,10,13,25,70,98,3,4,6,9,16,35,6,7,16,54,63,14,10,3,5,7,12,21,3,5,10,3,4,13,7,10,4,2,3,2,7,7,13,3,3,4,7,3,4,13,7,10,3,2,7,3,3,7,4,13,7,1,2,3,4,6,11,25,2,3,5,11,20,44,1,1,2,3,4,8,18,30,60
            137,5,8,13,22,42,110,4,7,12,20,41,120,3,5,8,12,22,47,10,18,2,3,6,9,15,31,2,3,4,6,11,24,8,9,12,23,66,92,3,4,6,9,15,33,6,7,15,51,59,13,9,3,4,7,11,20,3,5,9,3,4,12,6,9,4,2,3,2,6,7,12,3,3,3,6,3,4,12,6,9,3,2,6,3,3,7,3,12,6,1,2,2,4,6,10,23,2,3,5,11,19,41,1,1,2,3,4,7,17,29,57
            138,4,7,12,20,39,104,4,7,11,19,38,114,3,5,7,12,20,44,9,17,2,3,5,8,14,29,2,3,4,6,10,22,8,9,11,22,62,86,2,4,5,8,14,31,6,7,14,48,56,12,8,3,4,6,10,19,3,5,8,3,4,12,6,9,3,1,3,2,6,6,12,3,3,3,6,3,4,12,6,9,3,2,6,3,3,6,3,11,6,1,2,2,3,5,10,22,2,3,4,10,18,39,1,1,2,3,4,7,16,27,54
            139,4,7,11,19,37,98,4,6,10,17,36,107,2,4,7,11,19,41,9,16,2,3,5,8,13,27,1,2,4,6,10,21,7,8,11,20,58,81,2,3,5,8,13,29,5,6,13,45,52,12,8,3,4,6,9,17,3,4,8,3,4,11,6,8,3,1,3,2,5,6,11,3,3,3,5,3,4,11,6,8,3,2,5,3,3,6,3,11,5,1,2,2,3,5,9,20,2,2,4,9,17,36,1,1,2,2,4,7,15,25,51
            140,4,6,11,18,34,92,4,6,10,16,33,101,2,4,7,10,18,38,8,15,2,3,5,7,12,25,1,2,4,5,9,19,7,8,10,19,54,76,2,3,5,7,13,27,5,6,12,42,49,11,7,3,4,6,9,16,3,4,7,3,4,10,5,8,3,1,3,2,5,5,10,3,3,3,5,3,4,10,5,8,3,2,5,3,3,5,3,10,5,1,2,2,3,5,8,19,2,2,4,9,16,34,1,1,2,2,4,6,14,24,49
            141,4,6,10,17,32,87,3,6,9,15,31,96,2,4,6,10,17,36,8,14,2,3,4,7,11,24,1,2,3,5,9,18,6,7,9,18,51,71,2,3,4,7,12,25,5,5,12,40,46,10,7,3,4,5,8,15,3,4,7,3,3,10,5,7,3,1,3,2,5,5,9,3,3,3,5,3,3,10,5,7,3,2,5,3,3,5,3,9,5,1,2,2,3,4,8,18,2,2,4,8,15,32,1,1,2,2,3,6,13,22,46
            142,3,6,9,15,30,82,3,5,8,14,29,90,2,4,6,9,16,34,7,13,2,3,4,6,11,22,1,2,3,5,8,17,6,7,9,17,48,67,2,3,4,6,11,24,4,5,11,37,43,10,7,2,3,5,8,14,2,4,7,2,3,9,5,7,3,1,2,1,5,5,9,2,2,3,5,2,3,9,5,7,2,1,5,2,2,5,3,9,5,1,1,2,3,4,7,17,1,2,4,8,14,30,1,1,2,2,3,5,12,21,44
            143,3,5,9,15,28,77,3,5,8,13,27,85,2,3,5,8,15,32,7,12,2,2,4,6,10,21,1,2,3,4,8,16,6,6,8,16,45,62,2,3,4,6,10,22,4,5,10,35,41,9,6,2,3,5,7,13,2,3,6,2,3,8,4,6,3,1,2,1,4,5,8,2,2,2,4,2,3,8,4,6,2,1,4,2,2,5,2,8,4,1,1,2,3,4,7,16,1,2,3,7,13,28,1,1,1,2,3,5,11,20,41
            144,3,5,8,14,26,72,3,5,7,13,26,80,2,3,5,8,14,30,6,12,1,2,4,6,9,19,1,2,3,4,7,15,5,6,8,15,42,58,2,3,4,6,10,21,4,5,9,33,38,8,6,2,3,4,7,13,2,3,6,2,3,8,4,6,2,1,2,1,4,4,8,2,2,2,4,2,3,8,4,6,2,1,4,2,2,4,2,8,4,1,1,2,2,4,7,15,1,2,3,7,12,26,1,1,1,2,3,5,11,19,39
            145,3,5,8,13,25,68,3,4,7,12,24,75,2,3,5,7,13,28,6,11,1,2,3,5,9,18,1,2,3,4,7,14,5,6,7,14,39,55,2,2,3,5,9,20,4,4,9,31,36,8,5,2,3,4,6,12,2,3,5,2,3,7,4,6,2,1,2,1,4,4,7,2,2,2,4,2,3,7,4,5,2,1,4,2,2,4,2,7,4,1,1,2,2,3,6,14,1,2,3,6,11,25,1,1,1,2,3,5,10,18,37
            146,3,4,7,12,23,64,3,4,6,11,23,71,2,3,4,7,12,26,5,10,1,2,3,5,8,17,1,2,2,4,6,13,5,5,7,13,37,51,2,2,3,5,9,18,4,4,8,29,33,7,5,2,3,4,6,11,2,3,5,2,3,7,4,5,2,1,2,1,4,4,7,2,2,2,4,2,3,7,4,5,2,1,4,2,2,4,2,7,4,1,1,2,2,3,6,13,1,2,3,6,11,23,1,1,1,2,3,4,9,16,35
            147,3,4,7,11,22,60,2,4,6,10,21,67,2,3,4,7,11,24,5,10,1,2,3,5,8,16,1,2,2,4,6,12,4,5,6,12,35,48,2,2,3,5,8,17,3,4,8,27,31,7,5,2,3,4,6,10,2,3,5,2,2,7,3,5,2,1,2,1,3,4,6,2,2,2,3,2,2,7,3,5,2,1,3,2,2,4,2,6,3,1,1,2,2,3,5,12,1,2,3,6,10,22,1,1,1,2,2,4,9,15,33
            148,2,4,6,10,20,56,2,4,6,10,20,63,2,3,4,6,11,23,5,9,1,2,3,4,7,15,1,2,2,3,6,12,4,5,6,11,32,45,1,2,3,4,8,16,3,4,7,25,29,7,5,2,2,3,5,10,2,3,5,2,2,6,3,5,2,1,2,1,3,3,6,2,2,2,3,2,2,6,3,5,2,1,3,2,2,3,2,6,3,1,1,1,2,3,5,12,1,2,3,5,9,21,1,1,1,2,2,4,8,15,31
            149,2,4,6,10,19,53,2,3,5,9,19,59,1,2,4,6,10,21,5,8,1,2,3,4,7,14,1,1,2,3,5,11,4,4,6,11,30,42,1,2,3,4,7,15,3,3,7,24,28,6,4,2,2,3,5,9,2,2,4,2,2,6,3,4,2,1,2,1,3,3,6,2,2,2,3,2,2,6,3,4,2,1,3,2,2,3,2,6,3,1,1,1,2,3,5,11,1,1,2,5,9,19,1,1,1,1,2,4,8,14,29
            150,2,3,6,9,18,50,2,3,5,8,17,55,1,2,4,5,9,20,4,8,1,2,3,4,6,13,1,1,2,3,5,10,4,4,5,10,28,39,1,2,3,4,7,14,3,3,6,22,26,6,4,2,2,3,5,9,2,2,4,2,2,5,3,4,2,1,2,1,3,3,5,2,2,2,3,2,2,5,3,4,2,1,3,2,2,3,2,5,3,1,1,1,2,3,5,10,1,1,2,5,8,18,1,1,1,1,2,3,7,13,27
        """.trimIndent()
    }

    data class HandicapData(
            val roundInfo: FullRoundInfo,
            val isCompound: Boolean,
            val faceType: RoundFace,
            val roundName: String,
            val scores: List<Int>,
    ) {
        fun getHandicapsToTest(): List<HandicapPair> = getScoresToTest(false)

        fun getScoresToTest(testScores: Boolean = true): List<HandicapPair> {
            val tests = mutableListOf<HandicapPair>()

            for ((handicap, score) in scores.withIndex()) {
                val prevScore = scores.getOrNull(handicap - 1)
                val nextScore = scores.getOrNull(handicap + 1)

                if (!testScores && prevScore == score && nextScore == score) {
                    continue
                }
                if (testScores && nextScore == score) {
                    continue
                }
                tests.add(HandicapPair(handicap = handicap.toDouble(), score = score))

                if (testScores && nextScore != null && (score - 1) > nextScore) {
                    tests.add(HandicapPair(handicap = handicap + 1.0, score = score - 1))
                }
            }

            return tests
        }

        companion object {
            fun fromCsvRow(data: List<String>, dbData: Map<Int, FullRoundInfo>): HandicapData {

                val isCompound = data[4].takeIfNotNull() == "1"
                val faceType = data[5].takeIfNotNull()?.let { RoundFace.valueOf(it.uppercase()) } ?: RoundFace.FULL
                val roundId = data[7].takeIfNotNull()?.toInt()
                val roundName = data[8].takeIfNotNull()!!
                val scores = data.drop(9).map { it.toInt() }

                check(scores.size == 151) { "Scores size should be 151: ${scores.size}" }

                return HandicapData(
                        roundInfo = (
                                if (roundId != null) getFullRoundInfoFromRoundId(data, dbData)
                                else getFullRoundInfoFromSingleDistance(data)
                                ),
                        isCompound = isCompound,
                        faceType = faceType,
                        roundName = roundName,
                        scores = scores,
                )
            }

            private fun String.takeIfNotNull() = takeIf { it != "null" }

            private fun getFullRoundInfoFromRoundId(
                    data: List<String>,
                    dbData: Map<Int, FullRoundInfo>
            ): FullRoundInfo {
                val subtypeId = data[6].takeIfNotNull()?.toInt() ?: 1
                val roundId = data[7].takeIfNotNull()?.toInt()

                val info = dbData[roundId]!!
                return info.copy(
                        roundSubTypes = info.roundSubTypes?.filter { it.subTypeId == subtypeId },
                        roundDistances = info.roundDistances?.filter { it.subTypeId == subtypeId },
                )
            }

            private fun getFullRoundInfoFromSingleDistance(data: List<String>): FullRoundInfo {
                val isMetric = data[0].takeIfNotNull() == "1"
                val arrowCount = data[1].takeIfNotNull()?.toInt()!!
                val faceSizeInCm = data[2].takeIfNotNull()?.toInt()!!
                val distance = data[3].takeIfNotNull()?.toInt()!!
                val roundName = data[8].takeIfNotNull()!!

                return FullRoundInfo(
                        round = Round(
                                roundId = 1,
                                name = roundName,
                                displayName = roundName,
                                isOutdoor = true,
                                isMetric = isMetric,
                                fiveArrowEnd = roundName.lowercase().contains("worcester"),
                                legacyName = null,
                                defaultRoundId = null,
                        ),
                        roundSubTypes = emptyList(),
                        roundArrowCounts = listOf(
                                RoundArrowCount(
                                        roundId = 1,
                                        distanceNumber = 1,
                                        faceSizeInCm = faceSizeInCm.toDouble(),
                                        arrowCount = arrowCount,
                                )
                        ),
                        roundDistances = listOf(
                                RoundDistance(
                                        roundId = 1,
                                        distanceNumber = 1,
                                        subTypeId = 1,
                                        distance = distance,
                                )
                        ),
                )
            }
        }
    }

    data class HandicapOutcome(
            val expected: HandicapPair,
            val actual: Double,
            val roundName: String,
    ) {
        fun toHandicapString() = "$roundName - HC: ${expected.handicap} - expected: ${expected.score}, actual: $actual"
        fun toScoreString() =
                "$roundName - score: ${expected.score} - expected: ${expected.handicap}, actual: ${actual.roundHandicap()} ($actual)"
    }
}

